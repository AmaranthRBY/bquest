<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Blue Prince Bingo</title> 
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&family=Short+Stack&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/style.css" />
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to Main Content</a>
    
    <header class="py-2 bg-primary bg-opacity-75 shadow">
        <div class="container">
            <nav class="navbar navbar-expand-lg">
                <div class="container-fluid">
                    <a class="navbar-brand fs-2" href="#">
                        Blue Prince Bingo
                    </a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#main-nav" aria-controls="main-nav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse justify-content-end" id="main-nav">
                        <ul class="navbar-nav" id="main-nav-list">
                            <li class="nav-item">
                                <a href="https://www.bingosync.com/" class="nav-link" target="_blank">BingoSync</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    </header>
    
    <div id="app-1" class="bg-primary bg-opacity-25 pt-4">
        <div class="container site-content">
            <div class="row g-5">
                <div class="col-lg-4">
                    <h1 class="display-2">B Quest</h1>
                    <p class="fs-4 lh-base">
                        <i>B Quest</i> is a special form of non-lockout bingo that mimics the 9x5 grid of the manor blueprint in <i>Blue Prince</i> by using two 5x5 boards.
                    </p>
                    <div class="table-responsive">
                        <table class="table table-sm table-bordered text-center caption-top shadow">
                            <caption>Difficulty Distribution</caption>
                            <tr>
                                <th>9</th>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                                <td class="bg-danger"><span class="badge">Very Hard</span></td>
                                <td class="bg-primary"><span class="badge">Goal</span></td>
                                <td class="bg-danger"><span class="badge">Very Hard</span></td>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                            </tr>
                            <tr>
                                <th>8</th>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                                <td class="bg-danger"><span class="badge">Very Hard</span></td>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                            </tr>
                            <tr>
                                <th>7</th>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                            </tr>
                            <tr>
                                <th>6</th>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                                <td class="bg-warning"><span class="badge text-dark">Hard</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                            </tr>
                            <tr>
                                <th>5</th>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-danger"><span class="badge">Very Hard</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                            </tr>
                            <tr>
                                <th>4</th>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                            </tr>
                            <tr>
                                <th>3</th>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                                <td class="bg-success"><span class="badge">Medium</span></td>
                            </tr>
                            <tr>
                                <th>2</th>
                                <td class="bg-info"><span class="badge">Easy</span></td>
                                <td class="bg-info"><span class="badge">Easy</span></td>
                                <td class="bg-info"><span class="badge">Easy</span></td>
                                <td class="bg-info"><span class="badge">Easy</span></td>
                                <td class="bg-info"><span class="badge">Easy</span></td>
                            </tr>
                            <tr>
                                <th>1</th>
                                <td class="bg-info"><span class="badge">Easy</span></td>
                                <td class="bg-info"><span class="badge">Easy</span></td>
                                <td class="bg-secondary"><span class="badge">Start</span></td>
                                <td class="bg-info"><span class="badge">Easy</span></td>
                                <td class="bg-info"><span class="badge">Easy</span></td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="row gy-3">
                        <div class="col-lg-6 mb-3">
                            <div class="h3"><span class="badge bg-info text-dark">Easy</span></div>
                            <textarea class="form-control shadow" style="height: 260px" id="easyOnes">{{easyObjs}}</textarea>
                        </div>
                        <div class="col-lg-6 mb-3">
                            <div class="h3"><span class="badge bg-success">Medium</span></div>
                            <textarea class="form-control shadow" style="height: 260px" id="medOnes">{{mediumObjs}}</textarea>
                        </div>
                        <div class="col-lg-6 mb-3">
                            <div class="h3"><span class="badge bg-warning text-dark">Hard</span></div>
                            <textarea class="form-control shadow" style="height: 260px" id="hardOnes">{{hardObjs}}</textarea>
                        </div>
                        <div class="col-lg-6 mb-3">
                            <div class="h3"><span class="badge bg-danger">Very Hard</span></div>
                            <textarea class="form-control shadow" style="height: 260px" id="vhardOnes">{{vhardObjs}}</textarea>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-3 g-5">
                <div class="col-lg-4 mb-3">
                    <h2>B Quest: Two Boards</h2>
                    <input type="button" class="form-control btn btn-lg btn-primary py-4 mb-3 shadow" value="Build Boards" onclick="buildBoards()">
                    <p>
                        Press this to create two JSON arrays and create two BingoSync "Custom (Advanced)" boards set to "Non-Lockout".
                    </p>
                </div>
                <div class="col-lg-4 mb-3">
                    <label class="form-label fw-bold">Board 1 (Bottom)</label>
                    <textarea class="form-control shadow" style="height: 200px" id="board1"></textarea>
                </div>
                <div class="col-lg-4 mb-3">
                    <label class="form-label fw-bold">Board 2 (Top)</label>
                    <textarea class="form-control shadow" style="height: 200px" id="board2"></textarea>
                </div>
            </div>

            <div class="row mt-3 g-5">
                <div class="col-lg-4 mb-3">
                    <h2>Non-Lockout Squares</h2>
                    <div class="row">
                        <div class="col-lg">
                            <input type="button" class="form-control btn btn-lg btn-info mb-3 shadow" value="All Squares" onclick="dumpJson()">
                        </div>
                        <div class="col-lg">
                            <input type="button" class="form-control btn btn-lg btn-success mb-3 shadow" value="Balanced Card" onclick="dumpJsonWeighted()">
                        </div>
                    </div>
                    <p class="lh-base">
                        <b>All</b>> dumps all sqaures to a flat, un-weighted JSON string that can be used to generate a non-lockout board on BingoSync. The squares will already be shuffled, so you can use Fixed or Randomized.
                    </p>
                    <p class="lh-base">
                        <b>Balanced</b> randomly chooses 5 easy, 9 medium, 8 hard, and 3 very hard squares for a complete board.
                    </p>
                </div>
                <div class="col-lg-8 mb-3">
                    <label class="form-label fw-bold">Custom (Advanced): Fixed or Randomized (Squares Already Shuffled)</label>
                    <textarea class="form-control shadow" style="height: 250px" id="jsondump"></textarea>
                </div>
            </div>
        </div>
    </div>
    
    <!-- footers -->
    <footer class="site-footer bg-primary bg-opacity-50 py-4">
        <div class="container">
            Site by <a href="https://twitch.tv/radringtail">RadRingtail</a>
        </div>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/api-data.js"></script>
    <script>
        var app1 = new Vue({
            el: '#app-1',
            data: {
                objectives: objectiveData
            },
            computed: {
                easyObjs: function() {
                    var names = this.objectives.filter(e => e.difficulty == 1).map(x => x.name);
                    return names.join('\n');
                },
                mediumObjs: function() {
                    var names = this.objectives.filter(e => e.difficulty == 2).map(x => x.name);
                    return names.join('\n');
                },
                hardObjs: function() {
                    var names = this.objectives.filter(e => e.difficulty == 3).map(x => x.name);
                    return names.join('\n');
                },
                vhardObjs: function() {
                    var names = this.objectives.filter(e => e.difficulty == 4).map(x => x.name);
                    return names.join('\n');
                }
            }
        })

        function buildBoards(){
            var easyCards = $("#easyOnes").val().split('\n');
            var medCards = $("#medOnes").val().split('\n');
            var hardCards = $("#hardOnes").val().split('\n');
            var vhardCards = $("#vhardOnes").val().split('\n');

            // shuffle
            easyCards = shuffle(easyCards);
            medCards = shuffle(medCards);
            hardCards = shuffle(hardCards);
            vhardCards = shuffle(vhardCards);

            // pick rows
            var rank1 = [
                drawCard(easyCards),
                drawCard(easyCards),
                "START",
                drawCard(easyCards),
                drawCard(easyCards)
            ];

            var rank2 = [
                drawCard(easyCards),
                drawCard(easyCards),
                drawCard(easyCards),
                drawCard(easyCards),
                drawCard(easyCards)
            ];

            var rank3 = [
                drawCard(medCards),
                drawCard(medCards),
                drawCard(medCards),
                drawCard(medCards),
                drawCard(medCards)
            ];

            var rank4 = [
                drawCard(medCards),
                drawCard(medCards),
                drawCard(medCards),
                drawCard(medCards),
                drawCard(medCards)
            ];

            var rank5 = [
                drawCard(medCards),
                drawCard(medCards),
                drawCard(vhardCards),
                drawCard(medCards),
                drawCard(medCards)
            ];

            var rank6 = [
                drawCard(medCards),
                drawCard(hardCards),
                drawCard(hardCards),
                drawCard(hardCards),
                drawCard(medCards)
            ];

            var rank7 = [
                drawCard(hardCards),
                drawCard(hardCards),
                drawCard(hardCards),
                drawCard(hardCards),
                drawCard(hardCards)
            ];

            var rank8 = [
                drawCard(hardCards),
                drawCard(hardCards),
                drawCard(vhardCards),
                drawCard(hardCards),
                drawCard(hardCards)
            ];

            var rank9 = [
                drawCard(hardCards),
                drawCard(vhardCards),
                "GOAL",
                drawCard(vhardCards),
                drawCard(hardCards)
            ];

            var rank10 = ["N/A", "N/A", "N/A", "N/A", "N/A"];

            // combine
            var board1 = rank5.concat(rank4, rank3, rank2, rank1);
            var board2 = rank10.concat(rank9, rank8, rank7, rank6);

            var output1 = makeBingoSyncCard(board1);
            var output2 = makeBingoSyncCard(board2);

            $("#board1").val(output1);
            $("#board2").val(output2);
        }

        function dumpJson(){
            var easyCards = $("#easyOnes").val().split('\n');
            var medCards = $("#medOnes").val().split('\n');
            var hardCards = $("#hardOnes").val().split('\n');
            var vhardCards = $("#vhardOnes").val().split('\n');

            easyCards = shuffle(easyCards);
            medCards = shuffle(medCards);
            hardCards = shuffle(hardCards);
            vhardCards = shuffle(vhardCards);

            var allCards = easyCards.concat(medCards, hardCards, vhardCards);
            var cardJson = makeBingoSyncCard(allCards);

            $("#jsondump").val(cardJson);
        }

        function dumpJsonWeighted(){
            var easyCards = $("#easyOnes").val().split('\n');
            var medCards = $("#medOnes").val().split('\n');
            var hardCards = $("#hardOnes").val().split('\n');
            var vhardCards = $("#vhardOnes").val().split('\n');

            easyCards = shuffle(easyCards).slice(0, 5);
            medCards = shuffle(medCards).slice(0, 9);
            hardCards = shuffle(hardCards).slice(0, 8);
            vhardCards = shuffle(vhardCards).slice(0, 3);

            var allCards = easyCards.concat(medCards, hardCards, vhardCards);
            allCards = shuffle(allCards);
            var cardJson = makeBingoSyncCard(allCards);

            $("#jsondump").val(cardJson);
        }

        function drawCard(stack){
            var randomSpot = Math.floor(Math.random() * stack.length);
            var selectedCard = stack[randomSpot];
            stack.splice(randomSpot, 1);
            return selectedCard;
        }

        function makeBingoSyncCard(stack){
            var tempArray = [];

            stack.forEach(x => {
                var tempSquare = '{"name": "' + x + '"}';
                tempArray.push(tempSquare);
            });

            var output = '[';
            output = output + tempArray.join(",");
            output = output + ']';

            return output;
        }

        function shuffle(a) {
            var j, x, i;
            for (i = a.length - 1; i > 0; i--) {
                j = Math.floor(Math.random() * (i + 1));
                x = a[i];
                a[i] = a[j];
                a[j] = x;
            }
            return a;
        }
    </script>
</body>
</html>
